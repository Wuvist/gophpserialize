* Refactor code

# Thrift

* More documentation
* Handle null case
* return error instead of panic